train-0:   0%|          | 0/1221 [00:00<?, ?it/s]train-0:   0%|          | 1/1221 [00:02<54:16,  2.67s/it]train-0:   0%|          | 2/1221 [00:03<28:54,  1.42s/it]train-0:   0%|          | 3/1221 [00:03<20:41,  1.02s/it]train-0:   0%|          | 4/1221 [00:04<16:18,  1.24it/s]train-0:   0%|          | 5/1221 [00:04<14:04,  1.44it/s]train-0:   0%|          | 6/1221 [00:05<12:56,  1.57it/s]train-0:   1%|          | 7/1221 [00:05<12:00,  1.68it/s]train-0:   1%|          | 8/1221 [00:06<11:06,  1.82it/s]train-0:   1%|          | 9/1221 [00:06<10:46,  1.87it/s]train-0:   1%|          | 10/1221 [00:07<10:44,  1.88it/s]train-0:   1%|          | 11/1221 [00:07<10:27,  1.93it/s]train-0:   1%|          | 12/1221 [00:08<12:15,  1.64it/s]train-0:   1%|          | 13/1221 [00:09<12:25,  1.62it/s]train-0:   1%|          | 14/1221 [00:09<12:08,  1.66it/s]train-0:   1%|          | 15/1221 [00:10<10:43,  1.87it/s]train-0:   1%|▏         | 16/1221 [00:10<10:10,  1.97it/s]train-0:   1%|▏         | 17/1221 [00:11<09:58,  2.01it/s]train-0:   1%|▏         | 18/1221 [00:11<09:42,  2.07it/s]train-0:   2%|▏         | 19/1221 [00:12<09:53,  2.02it/s]train-0:   2%|▏         | 20/1221 [00:12<10:06,  1.98it/s]train-0:   2%|▏         | 21/1221 [00:12<09:40,  2.07it/s]train-0:   2%|▏         | 22/1221 [00:13<09:45,  2.05it/s]train-0:   2%|▏         | 23/1221 [00:13<09:40,  2.06it/s]train-0:   2%|▏         | 24/1221 [00:14<09:52,  2.02it/s]train-0:   2%|▏         | 25/1221 [00:15<10:06,  1.97it/s]train-0:   2%|▏         | 26/1221 [00:15<09:45,  2.04it/s]train-0:   2%|▏         | 27/1221 [00:16<10:29,  1.90it/s]train-0:   2%|▏         | 28/1221 [00:16<10:32,  1.89it/s]train-0:   2%|▏         | 29/1221 [00:17<10:16,  1.94it/s]train-0:   2%|▏         | 30/1221 [00:17<10:50,  1.83it/s]train-0:   3%|▎         | 31/1221 [00:18<10:13,  1.94it/s]train-0:   3%|▎         | 32/1221 [00:18<10:16,  1.93it/s]train-0:   3%|▎         | 33/1221 [00:19<11:11,  1.77it/s]train-0:   3%|▎         | 34/1221 [00:19<11:30,  1.72it/s]train-0:   3%|▎         | 35/1221 [00:20<11:48,  1.67it/s]train-0:   3%|▎         | 36/1221 [00:21<11:46,  1.68it/s]train-0:   3%|▎         | 37/1221 [00:21<11:05,  1.78it/s]train-0:   3%|▎         | 38/1221 [00:22<11:26,  1.72it/s]train-0:   3%|▎         | 39/1221 [00:22<11:06,  1.77it/s]train-0:   3%|▎         | 40/1221 [00:23<10:36,  1.86it/s]train-0:   3%|▎         | 41/1221 [00:24<11:35,  1.70it/s]train-0:   3%|▎         | 42/1221 [00:24<11:03,  1.78it/s]train-0:   4%|▎         | 43/1221 [00:25<10:50,  1.81it/s]train-0:   4%|▎         | 44/1221 [00:25<09:49,  2.00it/s]train-0:   4%|▎         | 45/1221 [00:25<09:32,  2.05it/s]train-0:   4%|▍         | 46/1221 [00:26<10:18,  1.90it/s]train-0:   4%|▍         | 47/1221 [00:27<11:29,  1.70it/s]train-0:   4%|▍         | 48/1221 [00:27<10:49,  1.81it/s]train-0:   4%|▍         | 49/1221 [00:28<10:31,  1.86it/s]train-0:   4%|▍         | 50/1221 [00:28<10:34,  1.85it/s]train-0:   4%|▍         | 51/1221 [00:29<11:18,  1.72it/s]train-0:   4%|▍         | 52/1221 [00:29<10:40,  1.82it/s]train-0:   4%|▍         | 53/1221 [00:30<10:13,  1.90it/s]train-0:   4%|▍         | 54/1221 [00:30<09:47,  1.99it/s]train-0:   5%|▍         | 55/1221 [00:31<09:29,  2.05it/s]train-0:   5%|▍         | 56/1221 [00:31<10:11,  1.90it/s]train-0:   5%|▍         | 57/1221 [00:32<09:54,  1.96it/s]train-0:   5%|▍         | 58/1221 [00:32<09:47,  1.98it/s]train-0:   5%|▍         | 59/1221 [00:33<09:44,  1.99it/s]train-0:   5%|▍         | 60/1221 [00:33<09:02,  2.14it/s]train-0:   5%|▍         | 61/1221 [00:34<08:28,  2.28it/s]train-0:   5%|▌         | 62/1221 [00:34<08:50,  2.19it/s]train-0:   5%|▌         | 63/1221 [00:35<09:44,  1.98it/s]train-0:   5%|▌         | 64/1221 [00:35<09:35,  2.01it/s]train-0:   5%|▌         | 65/1221 [00:36<09:48,  1.97it/s]train-0:   5%|▌         | 66/1221 [00:36<10:14,  1.88it/s]train-0:   5%|▌         | 67/1221 [00:37<09:53,  1.95it/s]train-0:   6%|▌         | 68/1221 [00:37<09:56,  1.93it/s]train-0:   6%|▌         | 69/1221 [00:38<08:58,  2.14it/s]train-0:   6%|▌         | 70/1221 [00:38<09:55,  1.93it/s]train-0:   6%|▌         | 71/1221 [00:39<09:54,  1.93it/s]train-0:   6%|▌         | 72/1221 [00:39<09:47,  1.95it/s]train-0:   6%|▌         | 73/1221 [00:40<09:33,  2.00it/s]train-0:   6%|▌         | 74/1221 [00:40<09:07,  2.09it/s]train-0:   6%|▌         | 75/1221 [00:41<09:20,  2.04it/s]train-0:   6%|▌         | 76/1221 [00:41<09:16,  2.06it/s]train-0:   6%|▋         | 77/1221 [00:42<09:31,  2.00it/s]train-0:   6%|▋         | 78/1221 [00:42<09:45,  1.95it/s]train-0:   6%|▋         | 79/1221 [00:43<09:51,  1.93it/s]train-0:   7%|▋         | 80/1221 [00:43<09:59,  1.90it/s]train-0:   7%|▋         | 81/1221 [00:44<09:42,  1.96it/s]train-0:   7%|▋         | 82/1221 [00:44<09:05,  2.09it/s]train-0:   7%|▋         | 83/1221 [00:45<09:08,  2.07it/s]train-0:   7%|▋         | 84/1221 [00:45<09:14,  2.05it/s]train-0:   7%|▋         | 85/1221 [00:46<09:19,  2.03it/s]train-0:   7%|▋         | 86/1221 [00:46<09:20,  2.02it/s]train-0:   7%|▋         | 87/1221 [00:47<08:37,  2.19it/s]train-0:   7%|▋         | 88/1221 [00:47<09:00,  2.10it/s]train-0:   7%|▋         | 89/1221 [00:48<09:30,  1.98it/s]train-0:   7%|▋         | 90/1221 [00:48<09:36,  1.96it/s]train-0:   7%|▋         | 91/1221 [00:49<10:27,  1.80it/s]train-0:   8%|▊         | 92/1221 [00:49<10:17,  1.83it/s]train-0:   8%|▊         | 93/1221 [00:50<11:16,  1.67it/s]train-0:   8%|▊         | 94/1221 [00:51<11:09,  1.68it/s]train-0:   8%|▊         | 95/1221 [00:51<09:54,  1.89it/s]train-0:   8%|▊         | 96/1221 [00:52<09:13,  2.03it/s]train-0:   8%|▊         | 97/1221 [00:52<09:16,  2.02it/s]train-0:   8%|▊         | 98/1221 [00:52<08:54,  2.10it/s]train-0:   8%|▊         | 99/1221 [00:53<10:45,  1.74it/s]train-0:   8%|▊         | 100/1221 [00:54<10:25,  1.79it/s]train-0:   8%|▊         | 101/1221 [00:54<10:52,  1.72it/s]train-0:   8%|▊         | 102/1221 [00:55<10:15,  1.82it/s]train-0:   8%|▊         | 103/1221 [00:55<10:37,  1.75it/s]train-0:   9%|▊         | 104/1221 [00:56<09:32,  1.95it/s]train-0:   9%|▊         | 105/1221 [00:56<09:35,  1.94it/s]train-0:   9%|▊         | 106/1221 [00:57<10:26,  1.78it/s]train-0:   9%|▉         | 107/1221 [00:58<09:57,  1.86it/s]train-0:   9%|▉         | 108/1221 [00:58<09:45,  1.90it/s]train-0:   9%|▉         | 109/1221 [00:59<09:44,  1.90it/s]train-0:   9%|▉         | 110/1221 [00:59<09:44,  1.90it/s]train-0:   9%|▉         | 111/1221 [01:00<09:42,  1.90it/s]train-0:   9%|▉         | 112/1221 [01:00<09:28,  1.95it/s]train-0:   9%|▉         | 113/1221 [01:01<09:45,  1.89it/s]train-0:   9%|▉         | 114/1221 [01:01<10:01,  1.84it/s]train-0:   9%|▉         | 115/1221 [01:02<09:46,  1.89it/s]train-0:  10%|▉         | 116/1221 [01:02<10:14,  1.80it/s]train-0:  10%|▉         | 117/1221 [01:03<10:01,  1.83it/s]train-0:  10%|▉         | 118/1221 [01:04<10:58,  1.67it/s]train-0:  10%|▉         | 119/1221 [01:04<10:11,  1.80it/s]train-0:  10%|▉         | 120/1221 [01:05<09:47,  1.87it/s]train-0:  10%|▉         | 121/1221 [01:05<10:06,  1.81it/s]train-0:  10%|▉         | 122/1221 [01:06<09:50,  1.86it/s]train-0:  10%|█         | 123/1221 [01:06<09:18,  1.96it/s]train-0:  10%|█         | 124/1221 [01:07<09:31,  1.92it/s]train-0:  10%|█         | 125/1221 [01:07<08:36,  2.12it/s]train-0:  10%|█         | 126/1221 [01:07<08:20,  2.19it/s]train-0:  10%|█         | 127/1221 [01:08<09:18,  1.96it/s]train-0:  10%|█         | 128/1221 [01:09<09:39,  1.89it/s]train-0:  11%|█         | 129/1221 [01:09<09:58,  1.82it/s]train-0:  11%|█         | 130/1221 [01:10<09:27,  1.92it/s]train-0:  11%|█         | 131/1221 [01:10<09:45,  1.86it/s]train-0:  11%|█         | 132/1221 [01:11<09:48,  1.85it/s]train-0:  11%|█         | 133/1221 [01:11<08:46,  2.07it/s]train-0:  11%|█         | 134/1221 [01:12<08:29,  2.13it/s]train-0:  11%|█         | 135/1221 [01:12<08:38,  2.09it/s]train-0:  11%|█         | 136/1221 [01:13<09:00,  2.01it/s]train-0:  11%|█         | 137/1221 [01:13<08:30,  2.12it/s]train-0:  11%|█▏        | 138/1221 [01:13<08:22,  2.15it/s]train-0:  11%|█▏        | 139/1221 [01:14<08:40,  2.08it/s]train-0:  11%|█▏        | 140/1221 [01:15<08:54,  2.02it/s]train-0:  12%|█▏        | 141/1221 [01:15<08:53,  2.02it/s]train-0:  12%|█▏        | 142/1221 [01:15<08:07,  2.21it/s]train-0:  12%|█▏        | 143/1221 [01:16<08:22,  2.15it/s]train-0:  12%|█▏        | 144/1221 [01:16<08:11,  2.19it/s]train-0:  12%|█▏        | 145/1221 [01:17<07:51,  2.28it/s]train-0:  12%|█▏        | 146/1221 [01:17<09:17,  1.93it/s]train-0:  12%|█▏        | 147/1221 [01:18<09:11,  1.95it/s]train-0:  12%|█▏        | 148/1221 [01:18<09:05,  1.97it/s]train-0:  12%|█▏        | 149/1221 [01:19<08:39,  2.06it/s]train-0:  12%|█▏        | 150/1221 [01:19<09:24,  1.90it/s]train-0:  12%|█▏        | 151/1221 [01:20<09:08,  1.95it/s]train-0:  12%|█▏        | 152/1221 [01:20<09:01,  1.97it/s]train-0:  13%|█▎        | 153/1221 [01:21<08:43,  2.04it/s]train-0:  13%|█▎        | 154/1221 [01:21<08:51,  2.01it/s]train-0:  13%|█▎        | 155/1221 [01:22<09:27,  1.88it/s]train-0:  13%|█▎        | 156/1221 [01:23<10:14,  1.73it/s]train-0:  13%|█▎        | 157/1221 [01:23<10:42,  1.66it/s]train-0:  13%|█▎        | 158/1221 [01:24<09:28,  1.87it/s]train-0:  13%|█▎        | 159/1221 [01:24<08:41,  2.04it/s]train-0:  13%|█▎        | 160/1221 [01:25<08:15,  2.14it/s]train-0:  13%|█▎        | 161/1221 [01:25<08:54,  1.98it/s]train-0:  13%|█▎        | 162/1221 [01:26<09:12,  1.92it/s]train-0:  13%|█▎        | 163/1221 [01:26<09:05,  1.94it/s]train-0:  13%|█▎        | 164/1221 [01:27<08:54,  1.98it/s]train-0:  14%|█▎        | 165/1221 [01:27<09:36,  1.83it/s]train-0:  14%|█▎        | 166/1221 [01:28<10:02,  1.75it/s]train-0:  14%|█▎        | 167/1221 [01:28<09:19,  1.88it/s]train-0:  14%|█▍        | 168/1221 [01:29<09:09,  1.92it/s]train-0:  14%|█▍        | 169/1221 [01:29<09:31,  1.84it/s]train-0:  14%|█▍        | 170/1221 [01:30<09:14,  1.89it/s]train-0:  14%|█▍        | 171/1221 [01:30<08:41,  2.01it/s]train-0:  14%|█▍        | 172/1221 [01:31<09:26,  1.85it/s]train-0:  14%|█▍        | 173/1221 [01:31<08:55,  1.96it/s]train-0:  14%|█▍        | 174/1221 [01:32<08:51,  1.97it/s]train-0:  14%|█▍        | 175/1221 [01:33<09:02,  1.93it/s]train-0:  14%|█▍        | 176/1221 [01:33<08:14,  2.12it/s]train-0:  14%|█▍        | 177/1221 [01:33<08:51,  1.96it/s]train-0:  15%|█▍        | 178/1221 [01:34<08:42,  2.00it/s]train-0:  15%|█▍        | 179/1221 [01:35<10:34,  1.64it/s]train-0:  15%|█▍        | 180/1221 [01:35<09:51,  1.76it/s]train-0:  15%|█▍        | 181/1221 [01:36<10:18,  1.68it/s]train-0:  15%|█▍        | 182/1221 [01:36<09:31,  1.82it/s]train-0:  15%|█▍        | 183/1221 [01:37<08:41,  1.99it/s]train-0:  15%|█▌        | 184/1221 [01:37<08:24,  2.05it/s]train-0:  15%|█▌        | 185/1221 [01:38<08:42,  1.98it/s]train-0:  15%|█▌        | 186/1221 [01:38<08:53,  1.94it/s]train-0:  15%|█▌        | 187/1221 [01:39<08:16,  2.08it/s]train-0:  15%|█▌        | 188/1221 [01:39<08:16,  2.08it/s]train-0:  15%|█▌        | 189/1221 [01:40<09:11,  1.87it/s]train-0:  16%|█▌        | 190/1221 [01:40<08:57,  1.92it/s]train-0:  16%|█▌        | 191/1221 [01:41<08:27,  2.03it/s]train-0:  16%|█▌        | 192/1221 [01:41<08:24,  2.04it/s]train-0:  16%|█▌        | 193/1221 [01:42<08:41,  1.97it/s]train-0:  16%|█▌        | 194/1221 [01:42<09:07,  1.88it/s]train-0:  16%|█▌        | 195/1221 [01:43<08:50,  1.93it/s]train-0:  16%|█▌        | 196/1221 [01:43<09:06,  1.88it/s]train-0:  16%|█▌        | 197/1221 [01:44<08:53,  1.92it/s]train-0:  16%|█▌        | 198/1221 [01:44<08:17,  2.06it/s]train-0:  16%|█▋        | 199/1221 [01:45<08:40,  1.96it/s]train-0:  16%|█▋        | 200/1221 [01:45<08:42,  1.95it/s]train-0:  16%|█▋        | 201/1221 [01:46<07:59,  2.13it/s]train-0:  17%|█▋        | 202/1221 [01:46<08:07,  2.09it/s]train-0:  17%|█▋        | 203/1221 [01:47<08:35,  1.98it/s]train-0:  17%|█▋        | 204/1221 [01:47<08:18,  2.04it/s]train-0:  17%|█▋        | 205/1221 [01:48<08:28,  2.00it/s]train-0:  17%|█▋        | 206/1221 [01:48<08:13,  2.06it/s]train-0:  17%|█▋        | 207/1221 [01:49<09:06,  1.85it/s]train-0:  17%|█▋        | 208/1221 [01:49<09:03,  1.87it/s]train-0:  17%|█▋        | 209/1221 [01:50<08:17,  2.04it/s]train-0:  17%|█▋        | 210/1221 [01:50<08:33,  1.97it/s]train-0:  17%|█▋        | 211/1221 [01:51<09:13,  1.83it/s]train-0:  17%|█▋        | 212/1221 [01:52<09:05,  1.85it/s]train-0:  17%|█▋        | 213/1221 [01:52<09:20,  1.80it/s]train-0:  18%|█▊        | 214/1221 [01:53<09:27,  1.78it/s]train-0:  18%|█▊        | 215/1221 [01:53<09:14,  1.81it/s]train-0:  18%|█▊        | 216/1221 [01:54<08:30,  1.97it/s]train-0:  18%|█▊        | 217/1221 [01:54<08:20,  2.01it/s]train-0:  18%|█▊        | 218/1221 [01:55<08:45,  1.91it/s]train-0:  18%|█▊        | 219/1221 [01:55<07:47,  2.14it/s]train-0:  18%|█▊        | 220/1221 [01:56<08:03,  2.07it/s]train-0:  18%|█▊        | 221/1221 [01:56<09:42,  1.72it/s]train-0:  18%|█▊        | 222/1221 [01:57<09:15,  1.80it/s]train-0:  18%|█▊        | 223/1221 [01:58<09:46,  1.70it/s]train-0:  18%|█▊        | 224/1221 [01:58<09:27,  1.76it/s]train-0:  18%|█▊        | 225/1221 [01:59<09:26,  1.76it/s]train-0:  19%|█▊        | 226/1221 [02:00<11:17,  1.47it/s]train-0:  19%|█▊        | 227/1221 [02:00<09:56,  1.67it/s]train-0:  19%|█▊        | 228/1221 [02:01<10:34,  1.57it/s]train-0:  19%|█▉        | 229/1221 [02:01<10:25,  1.59it/s]train-0:  19%|█▉        | 230/1221 [02:02<10:27,  1.58it/s]train-0:  19%|█▉        | 231/1221 [02:03<10:28,  1.57it/s]train-0:  19%|█▉        | 232/1221 [02:03<09:46,  1.69it/s]train-0:  19%|█▉        | 233/1221 [02:04<09:01,  1.82it/s]train-0:  19%|█▉        | 234/1221 [02:04<09:05,  1.81it/s]train-0:  19%|█▉        | 235/1221 [02:05<08:42,  1.89it/s]train-0:  19%|█▉        | 236/1221 [02:05<08:31,  1.92it/s]train-0:  19%|█▉        | 237/1221 [02:06<08:10,  2.01it/s]train-0:  19%|█▉        | 238/1221 [02:06<08:04,  2.03it/s]train-0:  20%|█▉        | 239/1221 [02:06<07:46,  2.11it/s]train-0:  20%|█▉        | 240/1221 [02:07<07:51,  2.08it/s]train-0:  20%|█▉        | 241/1221 [02:07<07:47,  2.09it/s]train-0:  20%|█▉        | 242/1221 [02:08<07:34,  2.15it/s]train-0:  20%|█▉        | 243/1221 [02:09<08:24,  1.94it/s]train-0:  20%|█▉        | 244/1221 [02:09<08:17,  1.96it/s]train-0:  20%|██        | 245/1221 [02:09<08:01,  2.03it/s]train-0:  20%|██        | 246/1221 [02:10<07:27,  2.18it/s]train-0:  20%|██        | 247/1221 [02:10<08:04,  2.01it/s]train-0:  20%|██        | 247/1221 [02:11<08:40,  1.87it/s]
Traceback (most recent call last):
  File "multitask_classifier.py", line 447, in <module>
    train_multitask(args)
  File "multitask_classifier.py", line 310, in train_multitask
    logits = model.predict(input_ids=b_ids,attention_mask=b_mask,token_type_ids=b_token_type_ids,task_id=b_task_id)
  File "multitask_classifier.py", line 78, in predict
    cls_hidden_state = self.forward(input_ids, attention_mask,token_type_ids)
  File "multitask_classifier.py", line 73, in forward
    bert_out = self.bert(input_ids, attention_mask,token_type_ids) 
  File "/scratch/usr/bzkurs49/anaconda3/envs/dnlp/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/bzkurs49/repos/word-alliance/bert.py", line 233, in forward
    sequence_output = self.encode(embedding_output, attention_mask=attention_mask)
  File "/home/bzkurs49/repos/word-alliance/bert.py", line 220, in encode
    hidden_states = layer_module(hidden_states, extended_attention_mask)
  File "/scratch/usr/bzkurs49/anaconda3/envs/dnlp/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/bzkurs49/repos/word-alliance/bert.py", line 137, in forward
    self_attention_output = self.self_attention.forward(hidden_states,attention_mask)
  File "/home/bzkurs49/repos/word-alliance/bert.py", line 83, in forward
    attn_value = self.attention(key_layer, query_layer, value_layer, attention_mask)
  File "/home/bzkurs49/repos/word-alliance/bert.py", line 58, in attention
    result_tensor = self.dropout(result_tensor)
  File "/scratch/usr/bzkurs49/anaconda3/envs/dnlp/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/scratch/usr/bzkurs49/anaconda3/envs/dnlp/lib/python3.8/site-packages/torch/nn/modules/dropout.py", line 59, in forward
    return F.dropout(input, self.p, self.training, self.inplace)
  File "/scratch/usr/bzkurs49/anaconda3/envs/dnlp/lib/python3.8/site-packages/torch/nn/functional.py", line 1252, in dropout
    return _VF.dropout_(input, p, training) if inplace else _VF.dropout(input, p, training)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 600.00 MiB (GPU 0; 39.43 GiB total capacity; 35.36 GiB already allocated; 127.75 MiB free; 37.98 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
